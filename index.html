<!DOCTYPE html>
<html>
    <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <title>åœ¨çº¿è½¬æ¢æ•´åˆ</title>
        <Link Rel="SHORTCUT ICON" href="./ICO.ico">
        <link rel="stylesheet" type="text/css" href="./index_files/index.css">
        <div align="left"><img src="./LOGO.png" tppabs="" alt="PatternFly logo" id="qq" class="wow fadeInDown animated"
        style="visibility: visible; animation-name: fadeInDown;"></div>
        <body background="./background.jpg"
            style="background-repeat:no-repeat;
            background-size:cover;
            background-attachment: fixed;">
        </body>
        <style>
        a {
        color: #bcbcbc;
        ;
        text-shadow: 1px 1px #000, -1px 1px #000, 1px -1px #000, -1px -1px #000;
        text-decoration: underline;
        font-family: sans-serif;
        }
        a:hover {
        color: #D3D3E7;
        text-shadow: 1px 1px #000, -1px 1px #000, 1px -1px #000, -1px -1px #000;
        }
        .splash{
        position: relative;
        }
        img#qq {
        width: 128px;
        background-size: cover;
        border-radius: 200px;
        box-shadow: 0px 0px 40px rgba(63, 81, 181, 0.72);
        border: 3px solid #00008B;
        opacity: 1;
        margin: 0 auto;
        margin-bottom: 20px;
        transition: all 1.0s;
        }
        #qq:hover {
        box-shadow: 0 0 10px #fff;
        -webkit-box-shadow: 0 0 19px #fff;
        transform:rotate(360deg);
        -ms-transform:rotate(360deg);   /* IE 9 */
        -moz-transform:rotate(360deg);  /* Firefox */
        -webkit-transform:rotate(360deg); /* Safari å’Œ Chrome */
        -o-transform:rotate(360deg);    /* Opera */
        filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
        }
        h2 {
        color: white;
        text-shadow: 1px 1px #000, -1px 1px #000, 1px -1px #000, -1px -1px #000;
        text-decoration: none;
        font-family: sans-serif;
        }
        #kd,
        #filepath,
        #decoded-area ,
        #encoded-area {
        background-color: rgba(211, 211, 231, 0.9);
        }
        #subtype,
        #a,
        #c {
        opacity: 0.9;
        }
                #fileInput,
        #t-button,
        #generate-link-button,
        input[type=button],
        #save-button,
        #save-button2,
        #b,
        #d,
        #decode-btn,
        #encode-btn {
        display: inline-block;
        padding: 5px;
        font-size: 18px;
        color: #fff;
        background-color: rgba(0, 95, 200, 0.9);
        border: none;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: background-color 0.2s ease-out;
        }
                #fileInput:hover,
        #t-button:hover,
        #generate-link-button:hover,
        #save-button:hover,
        #save-button2:hover,
        #encode-btn:hover,
        #decode-btn:hover,
        #d:hover,
        #b:hover,
        input[type=button]:hover{
        background-color: #0063cc;
        }
        .collapse {
        display: none;
        }
        </style>
    </head>
    
    <body>
        <header>
            <h2>æ ¸å¿ƒä»·å€¼è§‚</h2>
        </header>
        <div class="content">
            <textarea id="decoded-area" placeholder="Decoded Text Here"></textarea>
            <div class="buttons">
                
                <button id="encode-btn"> è½¬æˆä»·å€¼è§‚ &gt;&gt; </button>
                
                
                <button id="decode-btn"> &lt;&lt; è½¬å›è‡³é“¾æ¥ </button>
                
            </div>
            <textarea id="encoded-area" placeholder="Encoded Text Here"></textarea>
        </div>
        <script type="text/javascript" src="./index_files/bundle.js.ä¸‹è½½"></script>
        <div style="width: 100%; height: 1px; background-color: white;"><p></p></div>
        
        <header>
            <h2>ç™¾&emsp;å®¶&emsp;å§“</h2>
        </header>
        
        <div style="display:flex; justify-content:center;">
            <input type="text" id="c" style="width:400px;">
            <input type="button" id="d" value=" è½¬æˆç™¾å®¶å§“ &gt;&gt ">
            <input type="text" id="a" style="width:400px;">
            <input type="button" id="b" value=" &lt;&lt; è½¬æ¢æˆç£åŠ› "><br>
            <script>
            var t='magnet:?xt=urn:btih:';
            var obja={
            "èµµ":"0", "é’±":"1", "å­™":"2", "æ":"3", "å‘¨":"4", "å´":"5", "éƒ‘":"6", "ç‹":"7", "å†¯":"8", "é™ˆ":"9",
            "è¤š":"a", "å«":"b", "è’‹":"c", "æ²ˆ":"d", "éŸ©":"e", "æ¨":"f", "æœ±":"g", "ç§¦":"h", "å°¤":"i", "è®¸":"j",
            "ä½•":"k", "å•":"l", "æ–½":"m", "å¼ ":"n", "å­”":"o", "æ›¹":"p", "ä¸¥":"q", "å":"r", "é‡‘":"s", "é­":"t",
            "é™¶":"u", "å§œ":"v", "æˆš":"w", "è°¢":"x", "é‚¹":"y", "å–»":"z", "ç¦":"A", "æ°´":"B", "çª¦":"C", "ç« ":"D",
            "äº‘":"E", "è‹":"F", "æ½˜":"G", "è‘›":"H", "å¥š":"I", "èŒƒ":"J", "å½­":"K", "éƒ":"L", "é²":"M", "éŸ¦":"N",
            "æ˜Œ":"O", "é©¬":"P", "è‹—":"Q", "å‡¤":"R", "èŠ±":"S", "æ–¹":"T", "ä¿":"U", "ä»»":"V", "è¢":"W", "æŸ³":"X",
            "å”":"Y", "ç½—":"Z", "è–›":".", "ä¼":"-", "ä½™":"_", "ç±³":"+", "è´":"=", "å§š":"/", "å­Ÿ":"?", "é¡¾":"#",
            "å°¹":"%", "æ±Ÿ":"&", "é’Ÿ":"*"
            };
            var b = document.getElementById("b");
            b.addEventListener("click", function() {
            var str = document.getElementById("a").value;
            str=str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
            var strc = str.split("");
            var c  = '';
            for(var i=0;i<strc.length;i++){
            var o=cy(obja,strc[i]);
            c +=o;
            }
            c=t+c;
            document.getElementById('c').value=c;
            });
            var d = document.getElementById("d");
            d.addEventListener("click", function() {
            var str = document.getElementById("c").value;
            str=str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
            var v=str.replace(/magnet:\?xt=urn:btih:/,"");
            var strc = v.split("");
            var a  = '';
            for(var i=0;i<strc.length;i++){
            a +=ay(obja,strc[i]);
            }
            document.getElementById('a').value=a;
            });
            function cy(array,val){
            for( var key in array ){
            if(key==val){
            return array[key];
            }
            }
            return '';
            }
            function ay(array,val){
            for( var key in array ){
            if(array[key]==val){
            return key;
            }
            }
            return '';
            }
            </script>
        </div>
        <div style="width: 100%; height: 1px; background-color: white;"><p></p></div>
        
        <header>
            <h2><p>å¤– éƒ¨ é“¾ æ¥</p></h2>
        </header>
        <div style="display: flex; justify-content: center; align-items: center; gap: 20px;">
            <div style="margin: 0;"><font size="6"><b><a href="https://www.keyfc.net/bbs/tools/tudoucode.aspx"target="_blank">ä¸ä½›è®ºç¦…</a></b></font></div>
            <div style="margin: 0;"><font size="6"><b><a href="http://hi.pcmoe.net/index.html"target="_blank">ä¸ç†Šè®ºé“</a></b></font></div>
        </div>
        <div style="width: 100%; height: 1px; background-color: white;"><p></p></div>
        
        <header>
            <h2><p>ä¿®å¤txtæ–‡æœ¬éæ³•æ–­è¡Œ</p></h2>
        </header>
        <body>
            <div style="display: flex; justify-content: center;">
                <input type="file" id="fileInput" onchange="handleFileSelect(event)" accept=".txt" title="ç›®å‰ä»…æ”¯æŒä¿®å¤UTF-8æ–‡æœ¬"><br>
            </div>
            <script>
            // è‡ªåŠ¨è§¦å‘æ–‡ä»¶ä¸Šä¼ äº‹ä»¶
            let fileInput = document.getElementById("fileInput");
            fileInput.click();
            </script>
        </body>
        
        <script type="text/javascript">
        // è¯»å–ä¸Šä¼ çš„txtæ–‡ä»¶å¹¶è‡ªåŠ¨æ‹¼æ¥
        function handleFileSelect(evt) {
        let files = evt.target.files; // è·å–ç”¨æˆ·é€‰æ‹©çš„txtæ–‡ä»¶
        let text = ""; // ä¿å­˜æ–‡ä»¶å†…å®¹
        if (files.length == 0) return;
        let reader = new FileReader();
        reader.onload = function(e) { // å½“æ–‡ä»¶åŠ è½½å®Œæˆåæ‰§è¡Œ
        let lines = e.target.result.split('\n'); // å°†æ–‡ä»¶å†…å®¹æŒ‰è¡Œåˆ†å‰²ä¸ºæ•°ç»„
        // å¯¹æ¯ä¸€è¡Œè¿›è¡Œå¤„ç†å¹¶æ‹¼æ¥
        let formatted_lines = [];
        let buffer = '';
        for (let i = 0; i<lines.length; i++){
            let line = lines[i].trim(); // å»æ‰æ¯ä¸€è¡Œçš„æ¢è¡Œç¬¦
            // ä»¥ä¸‹æ˜¯æ–°å¢çš„å¤„ç†é€»è¾‘
            line = line.replace(/ã€Œ/g, 'â€œ').replace(/ã€/g, 'â€œ').replace(/ã€/g, 'â€').replace(/ã€/g, 'â€');
            if (line.length === 0){ // å¦‚æœè¿™ä¸€è¡Œä¸ºç©ºè¡Œï¼Œåˆ™ä¸éœ€è¦è¿›è¡Œå¤„ç†
            continue;
            }
            if ((line.includes('ç¬¬') && line.includes('ç« ')) && (line.length < 40)){ // å¦‚æœè¿™ä¸€è¡ŒåŒæ—¶å‡ºç°â€œç¬¬â€å’Œâ€œç« â€ä¸¤ä¸ªå­—ï¼Œå¹¶ä¸”è¿™è¡Œçš„æ€»å­—ç¬¦æ•°å°‘äº40ä¸ªæ±‰å­—ï¼Œåˆ™å°†è¯¥è¡Œä½œä¸ºä¸€æ®µï¼Œä¸ä¸ä¸‹ä¸€è¡Œæ‹¼æ¥
            line = line.trimStart(); // å»é™¤å¼€å¤´çš„ç©ºæ ¼
            formatted_lines.push(line);
            buffer = '';
            }
            else if (i < lines.length - 1 && !['.','ã€‚','?','ï¼Ÿ','!','ï¼',':','ï¼š',';','ï¼›','"','â€','â€œ','ï¼Š'].includes(line.slice(-1)) && (line.length > 25) && !line.endsWith('com') && !line.endsWith('cn') && !line.endsWith('â€¦â€¦')) { // å¦‚æœè¿™ä¸€è¡Œä¸æ˜¯æœ€åä¸€è¡Œä¸”æœ€åä¸€ä¸ªå­—ç¬¦ä¸æ˜¯æ ‡ç‚¹ç¬¦å·å’Œç‰¹æ®Šç¬¦å·ç»“å°¾ï¼Œåˆ™å°†è¯¥è¡Œå’Œä¸‹ä¸€è¡Œæ‹¼æ¥æˆä¸€æ•´æ®µ
            buffer += line.trimLeft();
            }
			else if (i < lines.length - 1 && (line.length = 1) && line.endsWith('â€œ')) {
			// å¦‚æœè¿™ä¸€è¡Œåªæœ‰ä¸€ä¸ªå­—ç¬¦â€œï¼Œåˆ™å°†è¯¥è¡Œå’Œä¸‹ä¸€è¡Œæ‹¼æ¥æˆä¸€æ•´æ®µ
            buffer += line.trimLeft();
            }
            else {
            buffer += line.trimLeft();
            // å¦‚æœä¸€è¡Œä¸­å‘ç°äº†ä¸‹å¼•å·ä¸Šå¼•å·ï¼Œåˆ™å°†å®ƒä»¬æ›¿æ¢æˆä¸‹å¼•å· + æ¢è¡Œç¬¦ + ä¸Šå¼•å·
            if (buffer.includes('â€â€œ')){
            buffer = buffer.replace('â€â€œ', 'â€\n    â€œ');
            }
            if (buffer.includes('ã€‚â€œ')){
            buffer = buffer.replace('ã€‚â€œ', 'ã€‚\n    â€œ');
            }
            // å¦‚æœè¡Œé¦–æ²¡æœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œåˆ™åœ¨å¼€å¤´æ·»åŠ å››ä¸ªç©ºæ ¼
            if (!buffer.startsWith(' ')){
            buffer = '    ' + buffer;
            }
            formatted_lines.push(buffer);
            buffer = '';
            }
            }
            text = formatted_lines.join('\n');
            // å°†å¤„ç†å®Œæˆçš„æ–‡æœ¬æ–‡ä»¶æä¾›ç»™ç”¨æˆ·ä¸‹è½½
			let blob = new Blob([text], {
			type: 'text/plain'
			});
			let url = URL.createObjectURL(blob);

			let downloadLink = document.createElement('a');
			downloadLink.href = url;

			// è·å–åŸæ–‡ä»¶åå¹¶æ·»åŠ ä¿®å¤å®Œæˆæ ‡è®°
			let fileName = files[0].name;
			let suffixIndex = fileName.lastIndexOf('.');
			let fixedFileName = fileName.substr(0, suffixIndex) + '_ä¿®å¤å®Œæˆ.txt';

			downloadLink.download = fixedFileName;
			downloadLink.click();
            };
            reader.readAsText(files[0]); // å°†æ–‡ä»¶å†…å®¹è¯»å–ä¸ºæ–‡æœ¬
            }
            </script>
            <div style="width: 100%; height: 1px; background-color: white;"><p></p></div>
            <header>
                <h2>æœºåœºè®¢é˜…è½¬æ¢</h2>
            </header>
            <button class="toggle-button" id="t-button" style="position: fixed;bottom: 0; left: 0;">ğŸ˜</button>
            <div class="my-div collapse">
                <div style="position: absolute;left: 50%; transform: translateX(-50%);">
                    <div style="color: #F8F8FF;text-shadow: 1px 1px #000, -1px 1px #000, 1px -1px #000, -1px -1px #000;"><b>
                        <p>1.å…ˆä¸‹è½½<a href="https://github.com/tindy2013/subconverter/releases" target="_blank">è®¢é˜…è½¬æ¢å·¥å…·</a>ï¼Œè§£å‹å¹¶è¿è¡Œ"subconverter.exe"</p>
                        <p>2.èŠ‚ç‚¹é“¾æ¥æˆ–æ–‡ä»¶è·¯å¾„ï¼š</p>
                        <textarea placeholder="æ”¯æŒå•ä¸ªèŠ‚ç‚¹ã€å¤šä¸ªèŠ‚ç‚¹ã€ç›´é“¾å’Œæœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼Œæ³¨æ„è·¯å¾„åŒ…æ‹¬æ–‡ä»¶ååœ¨å†…å¿…é¡»å…¨è‹±æ–‡" id="filepath" cols="100" rows="10"></textarea><br>
                        <p>3.å°†æ ¼å¼è½¬æ¢ä¸ºï¼š</p>
                        <select id="subtype" style="font-size: 18px;">
                            <option value="clash">Clash</option>
                            <option value="mixed">Base64é€šç”¨</option>
                        </select><br><br>
                        <input type="button" value="ç”Ÿæˆé“¾æ¥" onclick="create();"> <br> <br>
                        <textarea id="kd" placeholder="è¯·å…ˆå¡«å†™ä¸Šé¢çš„ç©ºæ ¼å¹¶ç‚¹å‡»ç”ŸæˆæŒ‰é’®ï¼Œå¤šæ¬¡è½¬æ¢è®°å¾—åˆ·æ–°ç½‘é¡µ" cols="100" rows="10"></textarea><br> <br>
                        <button id="save-button">ä¿å­˜æˆyamlæ–‡ä»¶</button><button id="save-button2" style="margin-left: 10px;">ä¿å­˜æˆtxtæ–‡ä»¶</button><br><br>
                        </b>
                    </div>
                </div>
            </div>
            
            <div style="position: fixed;bottom: 0; right: 0;">
                <button id="generate-link-button">è‡ªåŠ¨è·å–è®¢é˜…</button>
            </div>
            
            <script>
            let toggleButton = document.querySelector('.toggle-button');
            let content = document.querySelector('.my-div.collapse');
            toggleButton.addEventListener('click', () => {
            if (content.style.display === 'none') {
            content.style.display = 'block';
            toggleButton.textContent = 'ğŸ¥µ';
            } else {
            content.style.display = 'none';
            toggleButton.textContent = 'ğŸ˜';
            }
            });
            </script>
            
            <script>
            // Get the button element and add a click event listener
            var generateButton = document.getElementById("generate-link-button");
            generateButton.addEventListener("click", function() {
            // Get the current date and time
            var now = new Date();
            if (now.getHours() < 11) { // add condition to check if current time is before noon
            now.setDate(now.getDate() - 1); // set date to previous day
            }
            var formattedDate = formatDate(now);
            // Generate the link with the current date
            var link = "https://clashnode.com/wp-content/uploads/" + formattedDate.substr(0, 4) + "/" + formattedDate.substr(4, 2) + "/" + formattedDate + ".yaml";
            // Fill the textarea with the generated link
            var textarea = document.getElementById("filepath");
            textarea.value = link;
            // Copy the generated link to clipboard
            navigator.clipboard.writeText(link).then(function() {
            console.log('Link copied to clipboard.');
            }, function(error) {
            console.error('Failed to copy link: ', error);
            });
            });
            // Helper function to format the date as YYYYMMDD
            function formatDate(date) {
            var year = date.getFullYear();
            var month = date.getMonth() + 1;
            var day = date.getDate();
            if (month < 10) {
            month = "0" + month;
            }
            if (day < 10) {
            day = "0" + day;
            }
            return year + "" + month + "" + day;
            }
            </script>
            
            <script>
            const saveButton = document.querySelector("#save-button");
            const inputText = document.querySelector("#kd");
            saveButton.addEventListener("click", function() {
            const url = inputText.value;
            if (url === ""){
            alert("è¯·å…ˆå¡«å†™èŠ‚ç‚¹é“¾æ¥æˆ–æ–‡ä»¶è·¯å¾„å¹¶ç‚¹å‡»ç”Ÿæˆé“¾æ¥æŒ‰é’®ï¼");
            return false;
            }
            // åˆ¤æ–­æ˜¯å¦ä»¥"http://localhost:"å¼€å¤´
            if (url.startsWith("http://localhost:")) {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", url, true);
            xhr.responseType = "blob";
            
            xhr.onload = function() {
            if (xhr.status === 200) {
            const blob = xhr.response;
            const link = document.createElement("a");
            
            link.href = window.URL.createObjectURL(blob);
            link.download = "è®¢é˜…èŠ‚ç‚¹.yaml";
            link.click();
            }
            };
            
            xhr.send();
            }
            // å¦‚æœé“¾æ¥ä¸æ˜¯ä»¥"http://localhost:"å¼€å¤´ï¼Œåˆ™ä¸è¿›è¡Œä¸‹è½½æ“ä½œ
            });
            </script>
            
            <script>
            const saveButton2 = document.querySelector("#save-button2");
            const inputText2 = document.querySelector("#kd");
            saveButton2.addEventListener("click", function() {
            const url = inputText2.value;
            if (url === ""){
            alert("è¯·å…ˆå¡«å†™èŠ‚ç‚¹é“¾æ¥æˆ–æ–‡ä»¶è·¯å¾„å¹¶ç‚¹å‡»ç”Ÿæˆé“¾æ¥æŒ‰é’®ï¼");
            return false;
            }
            // åˆ¤æ–­æ˜¯å¦ä»¥"http://localhost:"å¼€å¤´
            if (url.startsWith("http://localhost:")) {
            const xhr = new XMLHttpRequest();
            xhr.open("GET", url, true);
            xhr.responseType = "blob";
            
            xhr.onload = function() {
            if (xhr.status === 200) {
            const blob = xhr.response;
            const link = document.createElement("a");
            
            link.href = window.URL.createObjectURL(blob);
            link.download = "è®¢é˜…èŠ‚ç‚¹.txt";
            link.click();
            }
            };
            
            xhr.send();
            }
            // å¦‚æœé“¾æ¥ä¸æ˜¯ä»¥"http://localhost:"å¼€å¤´ï¼Œåˆ™ä¸è¿›è¡Œä¸‹è½½æ“ä½œ
            });
            </script>
            
            <script>
            function  create() {
            var input = document.getElementById('content');
            var kd = document.getElementById('kd');
            var filepath = document.getElementById('filepath');
            var subtype = document.getElementById('subtype');
            if (filepath.value===""){
            alert("èŠ‚ç‚¹é“¾æ¥æˆ–æ–‡ä»¶è·¯å¾„ä¸èƒ½ä¸ºç©ºï¼");
            return false;
            }
            kd.href = 'http://localhost:25500/sub?target='+subtype.value+'&url='+encodeURIComponent((filepath.value).replace(/\n/g,"|"))+'&insert=false';
            kd.style = '';
            kd.innerText = 'http://localhost:25500/sub?target='+subtype.value+'&url='+encodeURIComponent((filepath.value).replace(/\n/g,"|"))+'&insert=false';
            }
            </script>
        </body>
    </html>